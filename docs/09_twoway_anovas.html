<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Bill Perry" />


<title>Data Modification</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bill Perry</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://wlperry.github.io/index.html">Bill's Homepage</a>
</li>
<li>
  <a href="https://wlperry.github.io/2018_stats/index.html">Stats and R Homepage</a>
</li>
<li>
  <a href="about.html">About Bill</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Data Modification</h1>
<h4 class="author">Bill Perry</h4>
<h4 class="date">2018/03/14</h4>

</div>


<div id="two-way-anovas" class="section level2">
<h2>Two Way Anovas</h2>
<p>###Ok so this is a completely fake dataset that I will update soon to make it more useful to illustrate Type I vs Type III errors but for now we will go with it.</p>
<p>###This section is for TWO WAY ANOVAs<br />
#### The items covered in this page are<br />
1. <a href="#load">Load libraries</a><br />
2. <a href="#make">Make separate Dataframes</a><br />
3. <a href="#bind">Make one dataframe and clean up</a><br />
4. <a href="#factors">Get ready for ANOVA</a><br />
5. <a href="#box">Boxplots</a><br />
6. <a href="#homogeneity">Test for homogeneity of variances</a><br />
7. <a href="#normality">Tests for normality</a><br />
8. <a href="#summary_stats">New summary statistics with RMISC</a><br />
9. <a href="#plots">Effect plots</a><br />
i. <a href="#main_effects">main effects</a><br />
ii. <a href="#interact_plots">Interaction Plots</a><br />
10. <a href="#two_way_aov">Finally the two way ANOVA</a> i. <a href="#summary">AOV summary</a> ii. <a href="#type_I">Type I - WRONG if unblaanced</a> 11. <a href="#assumptions">Assumptions of the model</a> 12. <a href="#post_hoc">Post Hoc tests</a> i. Main effects only ii. <a href="#post_hoc_interact">Interaction effects</a></p>
<p>####An absolutley great coverage of this material is Dolph Schluters page at: <a href="https://www.zoology.ubc.ca/~schluter/R/fit-model/" class="uri">https://www.zoology.ubc.ca/~schluter/R/fit-model/</a></p>
<p>The key thing here is the use of the car package as it is essential for unbalanced designs and the use of Type III sum of squares otherwise Type I sum of squares are used which is rarely good. Weather to use Type II or III is a contentious issue and we will just go with Type III for all of our work</p>
<p>###Load the libraries and data {#load}</p>
<pre class="r"><code># Standard use packages
library(tidyverse)
library(ggplot2)
library(dplyr)
library(tidyr)
library(readr)


#specific to anova and 2 way anova
library(broom)
library(car)
library(Rmisc)
library(Hmisc)
library(lsmeans)
# library(pwr)
# library(multcompView) # interferes with DPLYR load at the very end if we need to


# so rather han load data we are going to make it up from scratch:
# set up the sample sizes for each of the fixed varaibles we have
# male OR in lakes
orml=50
# female OR in lakes
orfl=50
# male OR in streams
orms=50
# female OR in streams
orfs=50</code></pre>
<p>###Now to make separate dataframes {#make}</p>
<pre class="r"><code># DATASET 1 ---- ---- ---- ---- ---- ---- ---- ---- ---- ----
#make dataframe for lake male OR
# create 50 random numbes between 34 and 55

set.seed(3)
cl &lt;- rnorm(orml, 38, 1.85)
sp &lt;- replicate(orml, &quot;or&quot;)
habitat &lt;- replicate(orml, &quot;lake&quot;)
sex &lt;- replicate(orml, &quot;male&quot;)
or_m_lake &lt;- cbind(habitat, sp, sex, cl)

# DATASET 2 ---- ---- ---- ---- ---- ---- ---- ----
#make dataframe for lake female OR
# create 50 random numbes between 34 and 60
set.seed(55)
cl &lt;- rnorm(orfl, 39, 1.75)
sp &lt;- replicate(orfl, &quot;or&quot;)
habitat &lt;- replicate(orfl, &quot;lake&quot;)
sex &lt;- replicate(orfl, &quot;female&quot;)
or_f_lake &lt;- cbind(habitat, sp, sex, cl)

# DATASET 3 ---- ---- ---- ---- ---- ---- ---- ----
#make dataframe for stream male OR
# create 50 random numbes between 28 and 38
set.seed(95)
cl &lt;- rnorm(orms, 33, 1.5)
sp &lt;- replicate(orms, &quot;or&quot;)
habitat &lt;- replicate(orms, &quot;stream&quot;)
sex &lt;- replicate(orms, &quot;male&quot;)
or_m_stream &lt;- cbind(habitat, sp, sex, cl)

# DATASET 4 ---- ---- ---- ---- ---- ---- ---- ----
#make dataframe for stream female OR
# create 50 random numbes between 28 and 50
set.seed(75)
cl &lt;- rnorm(orfs, 36, 2.5)
sp &lt;- replicate(orfs, &quot;or&quot;)
habitat &lt;- replicate(orfs, &quot;stream&quot;)
sex &lt;- replicate(orfs, &quot;female&quot;)
or_f_stream &lt;- cbind(habitat, sp, sex, cl)</code></pre>
<p>###Now to bind the dataframes together and clean up the code a bit {#bind}</p>
<pre class="r"><code># Bind the dataframes together ----
#Rbind merges things top to bottom
or_ls.df &lt;- as.data.frame(rbind(or_f_lake, or_m_lake, or_f_stream, or_m_stream))

# Make some new columns ----
#make a new column for some things below
or_ls.df &lt;- unite_(or_ls.df, &quot;sp_sex_habitat&quot;, c(&quot;sp&quot;, &quot;sex&quot;,&quot;habitat&quot;), sep=&quot;_&quot;, remove=FALSE)

#Get ride of all the garbage----
rm(cl, habitat, sex, sp, or_f_lake, or_m_lake, or_f_stream, or_m_stream)

#check dataframe and notice that cl is a factor
# sapply(or_ls.df, class)

# to convert to numeric takes this to make sure the number is preserved
# note this is a pain but it is how it has to be done.
or_ls.df$cl &lt;- as.numeric(as.character(or_ls.df$cl))

# take the log of the carapace length
or_ls.df$logcl &lt;- log(or_ls.df$cl)

head(or_ls.df)</code></pre>
<pre><code>##   sp_sex_habitat habitat sp    sex       cl    logcl
## 1 or_female_lake    lake or female 39.21024 3.668938
## 2 or_female_lake    lake or female 35.82834 3.578739
## 3 or_female_lake    lake or female 39.26527 3.670340
## 4 or_female_lake    lake or female 37.04136 3.612035
## 5 or_female_lake    lake or female 39.00334 3.663647
## 6 or_female_lake    lake or female 41.07991 3.715519</code></pre>
<p>###Now to look at the mechanics of a 2 WAY ANOVA - the set up {#factors}</p>
<pre class="r"><code>###NOW to two way anova ----
# need to make the categroical variable into factors 
or_ls.df$sex &lt;- as.factor(or_ls.df$sex)
or_ls.df$sp &lt;- as.factor(or_ls.df$sp)
or_ls.df$habitat &lt;- as.factor(or_ls.df$habitat)
or_ls.df$sp_sex_habitat &lt;- as.factor(or_ls.df$sp_sex_habitat)</code></pre>
<p>###Boxplots {#box}</p>
<pre class="r"><code># Look at the data with box plots
or_ls.df %&gt;%
  ggplot() +
  geom_boxplot(aes(x= sp_sex_habitat, y=cl)) +
  labs(y=&quot;Carapace length&quot;)</code></pre>
<p><img src="09_twoway_anovas_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>###Test for homogenetiy of variances {#homogeneity}</p>
<pre class="r"><code># Best to use the Levenes test compared to the Bartlet test    
# uses the car package   

# http://www.cookbook-r.com/Statistical_analysis/Homogeneity_of_variance/    
 
# #Test for homogeneity of variances by groups
leveneTest(cl ~ sp_sex_habitat, data=or_ls.df)</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value Pr(&gt;F)
## group   3   1.381 0.2498
##       196</code></pre>
<pre class="r"><code>#Compared to the Bartlet test
bartlett.test(cl ~ sp_sex_habitat, data=or_ls.df)</code></pre>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  cl by sp_sex_habitat
## Bartlett&#39;s K-squared = 5.3469, df = 3, p-value = 0.1481</code></pre>
<p>THIS IS FOR 2 Way AOV With multiple independent variables, the interaction() function must be used to collapse the IV’s into a single variable with all combinations of the factors. If it is not used, then the will be the wrong degrees of freedom, and the p-value will be wrong.</p>
<p>###Test for normality of data {#normality}</p>
<pre class="r"><code># SHAPIRO_WILK TEST FOR NORMALITY----
# turn off scientific notaton
options(scipen = 999)
# to turn back on
#options(scipen = 0)

# Test for normality of each group and store in shapirowilktests
# This uses the broom package to get clean output of the test
or_ls.df %&gt;% group_by(sex, habitat) %&gt;% do(tidy(shapiro.test(.$cl)))</code></pre>
<pre><code>## # A tibble: 4 x 5
## # Groups:   sex, habitat [4]
##   sex    habitat statistic p.value method                     
##   &lt;fct&gt;  &lt;fct&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                      
## 1 female lake        0.990   0.938 Shapiro-Wilk normality test
## 2 female stream      0.982   0.622 Shapiro-Wilk normality test
## 3 male   lake        0.975   0.370 Shapiro-Wilk normality test
## 4 male   stream      0.985   0.757 Shapiro-Wilk normality test</code></pre>
<pre class="r"><code># they are a bit off surprisingly but go with it anyway and test residuals
# to see if the result is the same</code></pre>
<div id="summary_stats" class="section level3">
<h3>Some basic Statistics in a new way</h3>
<pre class="r"><code>#Summary Stats----
# Do this to get the for N, Means Sd, Se, and CI
# need Rmisc library installed to do this
summary = summarySE(or_ls.df, 
                measurevar=&quot;cl&quot;, 
                groupvars=c(&quot;habitat&quot;,&quot;sex&quot;))
summary</code></pre>
<pre><code>##   habitat    sex  N       cl       sd        se        ci
## 1    lake female 50 39.08726 1.682961 0.2380067 0.4782923
## 2    lake   male 50 37.88174 1.646132 0.2327982 0.4678255
## 3  stream female 50 35.98787 2.188953 0.3095647 0.6220936
## 4  stream   male 50 32.89608 1.756239 0.2483696 0.4991175</code></pre>
</div>
<div id="main_effects" class="section level3">
<h3>Lets look at the basic plots of the effects and interactions</h3>
<pre class="r"><code>#Simple box plot of main effect and interaction
# this is the main effect of sit and season
boxplot(cl ~ sex,
        data = or_ls.df,
        xlab = &quot;Sex&quot;,
        ylab = &quot;carapace length&quot;)</code></pre>
<p><img src="09_twoway_anovas_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>#Simple box plot of main effect and interaction
# this is the main effect of sit and season
boxplot(cl ~ habitat,
        data = or_ls.df,
        xlab = &quot;Habitat&quot;,
        ylab = &quot;carapace length&quot;)</code></pre>
<p><img src="09_twoway_anovas_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code># box plots of the site and season
boxplot(cl ~ habitat:sex,
        data = or_ls.df,
        xlab = &quot;Habitat&quot;,
        ylab = &quot;carapace length&quot;)</code></pre>
<p><img src="09_twoway_anovas_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>###Interaction Plots {#interact_plots}</p>
<pre class="r"><code># Interaction Plots----
# This will generate two plots to compare groups according to the 
# and examine interactions
# par(mfrow=c(1,3)) could use this to make multiple per page but is not great
interaction.plot(or_ls.df$habitat, or_ls.df$sex, or_ls.df$cl)</code></pre>
<p><img src="09_twoway_anovas_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>interaction.plot(or_ls.df$sex,  or_ls.df$habitat, or_ls.df$cl)</code></pre>
<p><img src="09_twoway_anovas_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>###TWO WAY AOV MODEL—-<br />
This is the two way ANOVA<br />
What you are looking for in here is the * after the value. if that is there then it is signficant. Below you would first look at the one where it is site:season - because if this is signifcant this is all you will analyze in the post anova or post F tests. If the interaction of site:season is not significant you would then look at the individual factors of season or site indiependently.</p>
<p>The way to read the results below is that the interaction and sites are not significant but season is significant and since there are only two you really dont need to do the post F test as it will just say the same thing but it woudl be differnet if you and more than one season for instance.</p>
</div>
<div id="two_way_aov" class="section level3">
<h3>NOW FOR THE 2 WAY ANOVA</h3>
<pre class="r"><code>#THE TWO WAY AOV----
# Here is a two way AOV looking at site and season with the pairwise comparisons at the end
# Setting something as FACTOR makes it so that you are looking at these as categorical varaibles to compare the means of the two
# Type III is used for unbalanced designs when there are unequal numbers of samples in teh various categories or groups which is an unbalanced design


# Set it up for Type III SS ANOVA
options(contrasts = c(&quot;contr.sum&quot;, &quot;contr.poly&quot;))

# Fit the linear model and conduct ANOVA
model = lm(cl ~ sex*habitat, data=or_ls.df)
Anova(model, type=&quot;III&quot;)       # Use type=&quot;III&quot; ALWAYS!!!!</code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: cl
##             Sum Sq  Df   F value                Pr(&gt;F)    
## (Intercept) 265914   1 79270.705 &lt; 0.00000000000000022 ***
## sex            231   1    68.814   0.00000000000001717 ***
## habitat        817   1   243.584 &lt; 0.00000000000000022 ***
## sex:habitat     44   1    13.258             0.0003472 ***
## Residuals      657 196                                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>###Now a summary of the model {#summary}</p>
<pre class="r"><code># Are they the same? = Try running model with different data

# this produces R-Squared and overall p-value and parameter estimates
summary(model)     # Produces r-square, overall p-value, parameter estimates</code></pre>
<pre><code>## 
## Call:
## lm(formula = cl ~ sex * habitat, data = or_ls.df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.0727 -1.2458 -0.0895  1.3662  5.7352 
## 
## Coefficients:
##               Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)    36.4632     0.1295 281.551 &lt; 0.0000000000000002 ***
## sex1            1.0743     0.1295   8.295   0.0000000000000172 ***
## habitat1        2.0213     0.1295  15.607 &lt; 0.0000000000000002 ***
## sex1:habitat1  -0.4716     0.1295  -3.641             0.000347 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.832 on 196 degrees of freedom
## Multiple R-squared:  0.6243, Adjusted R-squared:  0.6185 
## F-statistic: 108.6 on 3 and 196 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>{#type_I}</p>
<pre class="r"><code>## THIS WILL DO A TYPE I ANOVA
 anova(model)      # does the type I ANOVA </code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: cl
##              Df Sum Sq Mean Sq F value                Pr(&gt;F)    
## sex           1 230.83  230.83  68.814   0.00000000000001717 ***
## habitat       1 817.10  817.10 243.584 &lt; 0.00000000000000022 ***
## sex:habitat   1  44.48   44.48  13.258             0.0003472 ***
## Residuals   196 657.48    3.35                                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># NOTICE THE LOWER CASE A!!!!!</code></pre>
</div>
<div id="assumptions" class="section level3">
<h3>Checking assumptions of the model</h3>
<div id="histogram-of-residuals-from-a-linear-model." class="section level4">
<h4>Histogram of residuals from a linear model.</h4>
</div>
</div>
</div>
<div id="the-distribution-of-these-residuals-should-be-approximately-normal." class="section level1">
<h1>The distribution of these residuals should be approximately normal.</h1>
<pre class="r"><code>hist(residuals(model), 
     col=&quot;darkgray&quot;)</code></pre>
<p><img src="09_twoway_anovas_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div id="graphic-test-for-normal-residuals" class="section level3">
<h3>Graphic test for normal residuals</h3>
<pre class="r"><code>qqnorm(model$res)</code></pre>
<p><img src="09_twoway_anovas_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="test-for-normality-" class="section level3">
<h3>test for normality—-</h3>
<pre class="r"><code>shapiro.test(model$res)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  model$res
## W = 0.99461, p-value = 0.6915</code></pre>
</div>
</div>
<div id="a-plot-of-residuals-vs.predicted-values." class="section level1">
<h1>A plot of residuals vs. predicted values.</h1>
</div>
<div id="the-residuals-should-be-unbiased-and-homoscedastic." class="section level1">
<h1>The residuals should be unbiased and homoscedastic.</h1>
</div>
<div id="for-an-illustration-of-these-properties-see-this-diagram-by" class="section level1">
<h1>For an illustration of these properties, see this diagram by</h1>
</div>
<div id="steve-jost-at-depaul-university" class="section level1">
<h1>Steve Jost at DePaul University:</h1>
</div>
<div id="condor.depaul.edusjostit223documentsresid-plots.gif." class="section level1">
<h1># condor.depaul.edu/sjost/it223/documents/resid-plots.gif.</h1>
<pre class="r"><code>plot(model,1)</code></pre>
<p><img src="09_twoway_anovas_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>#Equality of variances with Levenes # Check for equality of variance across the two groups. # If this is signficant we will have to transform the data. # The Levene’s test uses the library(car)</p>
<pre class="r"><code>leveneTest(or_ls.df$cl ~ or_ls.df$sex * or_ls.df$habitat)</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value Pr(&gt;F)
## group   3   1.381 0.2498
##       196</code></pre>
<div id="post_hoc" class="section level3">
<h3>POST HOC ANALYSIS</h3>
</div>
</div>
<div id="one-advantage-of-the-using-the-package-for-post-hoc-tests-is-that-it" class="section level1">
<h1>One advantage of the using the package for post-hoc tests is that it</h1>
</div>
<div id="can-produce-comparisons-for-interaction-effects." class="section level1">
<h1>can produce comparisons for interaction effects.</h1>
<pre class="r"><code>lsmseason = pairs(lsmeans(model,&quot;habitat&quot;), adjust=&quot;bonferroni&quot;)</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre class="r"><code>### Means sharing a letter in .group are not significantly different
# when more than one categorical varaible
# cld(lsmseason, 
#     alpha=.05, 
#     Letters=letters)

test(lsmseason)</code></pre>
<pre><code>##  contrast      estimate    SE  df t.ratio p.value
##  lake - stream     4.04 0.259 196 15.607  &lt;.0001 
## 
## Results are averaged over the levels of: sex</code></pre>
<pre class="r"><code>lsmseason.sex = pairs(lsmeans(model,&quot;sex&quot;), adjust=&quot;bonferroni&quot;)</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre class="r"><code>### Means sharing a letter in .group are not significantly different
# when more than one categorical varaible
# cld(lsmseason, 
#     alpha=.05, 
#     Letters=letters)

test(lsmseason.sex)</code></pre>
<pre><code>##  contrast      estimate    SE  df t.ratio p.value
##  female - male     2.15 0.259 196 8.295   &lt;.0001 
## 
## Results are averaged over the levels of: habitat</code></pre>
<div id="post_hoc_interact" class="section level3">
<h3>POST HOC ANALYSIS</h3>
</div>
</div>
<div id="one-advantage-of-the-using-the-package-for-post-hoc-tests-is-that-it-1" class="section level1">
<h1>One advantage of the using the package for post-hoc tests is that it</h1>
</div>
<div id="can-produce-comparisons-for-interaction-effects.-1" class="section level1">
<h1>can produce comparisons for interaction effects.</h1>
<pre class="r"><code>lsminteraction = emmeans(model, 
                         pairwise ~ habitat:sex,
                         adjust=&quot;bonferroni&quot;)

lsminteraction$contrasts</code></pre>
<pre><code>##  contrast                    estimate    SE  df t.ratio p.value
##  lake,female - stream,female     3.10 0.366 196  8.461  &lt;.0001 
##  lake,female - lake,male         1.21 0.366 196  3.291  0.0071 
##  lake,female - stream,male       6.19 0.366 196 16.902  &lt;.0001 
##  stream,female - lake,male      -1.89 0.366 196 -5.170  &lt;.0001 
##  stream,female - stream,male     3.09 0.366 196  8.440  &lt;.0001 
##  lake,male - stream,male         4.99 0.366 196 13.611  &lt;.0001 
## 
## P value adjustment: bonferroni method for 6 tests</code></pre>
<pre class="r"><code># test(lsmsite)</code></pre>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-88373117-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-88373117-4');
</script>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
