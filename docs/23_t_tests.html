<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Bill Perry" />


<title>Ttests</title>

<script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bill Perry</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://wlperry.github.io/index.html">Bill's Homepage</a>
</li>
<li>
  <a href="https://wlperry.github.io/2018_stats/index.html">Stats and R Homepage</a>
</li>
<li>
  <a href="about.html">About Bill</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Ttests</h1>
<h4 class="author">Bill Perry</h4>
<h4 class="date">2018/03/14</h4>

</div>


<div id="t-tests" class="section level2">
<h2>T Tests</h2>
<p>##Load libraries We will read in the main files and load the libraries as we have worked with so far.</p>
<pre class="r"><code># One new package for summary stats
#install.packages(&quot;broom&quot;)
# install.packages(&quot;GGally&quot;)
# install.packages(&quot;car&quot;)
# install.packages(&quot;gvlma&quot;)


# load the libraries each time you restart R
library(tidyverse)
library(lubridate)
library(scales)
library(skimr)
library(janitor)
library(patchwork)
# library(reshape2)
library(broom)
library(GGally)
library(corrplot)
library(car)</code></pre>
</div>
<div id="read-in-file" class="section level2">
<h2>Read in file</h2>
<pre class="r"><code># read in the file
iris.df &lt;- read_csv(&quot;data/iris.csv&quot;) %&gt;%
  clean_names() %&gt;%
  remove_empty(c(&quot;rows&quot;, &quot;cols&quot;)) </code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   Sepal.Length = col_double(),
##   Sepal.Width = col_double(),
##   Petal.Length = col_double(),
##   Petal.Width = col_double(),
##   Species = col_character()
## )</code></pre>
<pre class="r"><code>glimpse(iris.df)</code></pre>
<pre><code>## Rows: 150
## Columns: 5
## $ sepal_length &lt;dbl&gt; 5.1, NA, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.8…
## $ sepal_width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.…
## $ petal_length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.…
## $ petal_width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.…
## $ species      &lt;chr&gt; &quot;setosa&quot;, &quot;setosa&quot;, &quot;setosa&quot;, &quot;setosa&quot;, &quot;setosa&quot;, &quot;setosa…</code></pre>
<p>###Summary Statistics for the better look ###So this is a lot different than thinking about data from excel<br />
Lets try to do the summary stats on the data now and see how it differs</p>
<pre class="r"><code># the data you want to look at
skim(iris.df)</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">iris.df</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">150</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">species</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sepal_length</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">5.85</td>
<td align="right">0.83</td>
<td align="right">4.3</td>
<td align="right">5.1</td>
<td align="right">5.80</td>
<td align="right">6.4</td>
<td align="right">7.9</td>
<td align="left">▆▇▇▅▂</td>
</tr>
<tr class="even">
<td align="left">sepal_width</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">3.06</td>
<td align="right">0.44</td>
<td align="right">2.0</td>
<td align="right">2.8</td>
<td align="right">3.00</td>
<td align="right">3.3</td>
<td align="right">4.4</td>
<td align="left">▁▆▇▂▁</td>
</tr>
<tr class="odd">
<td align="left">petal_length</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">3.76</td>
<td align="right">1.77</td>
<td align="right">1.0</td>
<td align="right">1.6</td>
<td align="right">4.35</td>
<td align="right">5.1</td>
<td align="right">6.9</td>
<td align="left">▇▁▆▇▂</td>
</tr>
<tr class="even">
<td align="left">petal_width</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1.20</td>
<td align="right">0.76</td>
<td align="right">0.1</td>
<td align="right">0.3</td>
<td align="right">1.30</td>
<td align="right">1.8</td>
<td align="right">2.5</td>
<td align="left">▇▁▇▅▃</td>
</tr>
</tbody>
</table>
<pre class="r"><code>iris.df %&gt;% group_by(species) %&gt;% skim_to_wide()</code></pre>
<pre><code>## Warning: &#39;skim_to_wide&#39; is deprecated.
## Use &#39;skim()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">.data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">150</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">species</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="left">species</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sepal_length</td>
<td align="left">setosa</td>
<td align="right">1</td>
<td align="right">0.98</td>
<td align="right">5.01</td>
<td align="right">0.36</td>
<td align="right">4.3</td>
<td align="right">4.80</td>
<td align="right">5.00</td>
<td align="right">5.20</td>
<td align="right">5.8</td>
<td align="left">▃▃▇▅▁</td>
</tr>
<tr class="even">
<td align="left">sepal_length</td>
<td align="left">versicolor</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">5.94</td>
<td align="right">0.52</td>
<td align="right">4.9</td>
<td align="right">5.60</td>
<td align="right">5.90</td>
<td align="right">6.30</td>
<td align="right">7.0</td>
<td align="left">▂▇▆▃▃</td>
</tr>
<tr class="odd">
<td align="left">sepal_length</td>
<td align="left">virginica</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">6.59</td>
<td align="right">0.64</td>
<td align="right">4.9</td>
<td align="right">6.23</td>
<td align="right">6.50</td>
<td align="right">6.90</td>
<td align="right">7.9</td>
<td align="left">▁▃▇▃▂</td>
</tr>
<tr class="even">
<td align="left">sepal_width</td>
<td align="left">setosa</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">3.43</td>
<td align="right">0.38</td>
<td align="right">2.3</td>
<td align="right">3.20</td>
<td align="right">3.40</td>
<td align="right">3.68</td>
<td align="right">4.4</td>
<td align="left">▁▃▇▅▂</td>
</tr>
<tr class="odd">
<td align="left">sepal_width</td>
<td align="left">versicolor</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2.77</td>
<td align="right">0.31</td>
<td align="right">2.0</td>
<td align="right">2.52</td>
<td align="right">2.80</td>
<td align="right">3.00</td>
<td align="right">3.4</td>
<td align="left">▁▅▆▇▂</td>
</tr>
<tr class="even">
<td align="left">sepal_width</td>
<td align="left">virginica</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2.97</td>
<td align="right">0.32</td>
<td align="right">2.2</td>
<td align="right">2.80</td>
<td align="right">3.00</td>
<td align="right">3.18</td>
<td align="right">3.8</td>
<td align="left">▂▆▇▅▁</td>
</tr>
<tr class="odd">
<td align="left">petal_length</td>
<td align="left">setosa</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1.46</td>
<td align="right">0.17</td>
<td align="right">1.0</td>
<td align="right">1.40</td>
<td align="right">1.50</td>
<td align="right">1.58</td>
<td align="right">1.9</td>
<td align="left">▁▃▇▃▁</td>
</tr>
<tr class="even">
<td align="left">petal_length</td>
<td align="left">versicolor</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">4.26</td>
<td align="right">0.47</td>
<td align="right">3.0</td>
<td align="right">4.00</td>
<td align="right">4.35</td>
<td align="right">4.60</td>
<td align="right">5.1</td>
<td align="left">▂▂▇▇▆</td>
</tr>
<tr class="odd">
<td align="left">petal_length</td>
<td align="left">virginica</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">5.55</td>
<td align="right">0.55</td>
<td align="right">4.5</td>
<td align="right">5.10</td>
<td align="right">5.55</td>
<td align="right">5.88</td>
<td align="right">6.9</td>
<td align="left">▃▇▇▃▂</td>
</tr>
<tr class="even">
<td align="left">petal_width</td>
<td align="left">setosa</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.25</td>
<td align="right">0.11</td>
<td align="right">0.1</td>
<td align="right">0.20</td>
<td align="right">0.20</td>
<td align="right">0.30</td>
<td align="right">0.6</td>
<td align="left">▇▂▂▁▁</td>
</tr>
<tr class="odd">
<td align="left">petal_width</td>
<td align="left">versicolor</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1.33</td>
<td align="right">0.20</td>
<td align="right">1.0</td>
<td align="right">1.20</td>
<td align="right">1.30</td>
<td align="right">1.50</td>
<td align="right">1.8</td>
<td align="left">▅▇▃▆▁</td>
</tr>
<tr class="even">
<td align="left">petal_width</td>
<td align="left">virginica</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2.03</td>
<td align="right">0.27</td>
<td align="right">1.4</td>
<td align="right">1.80</td>
<td align="right">2.00</td>
<td align="right">2.30</td>
<td align="right">2.5</td>
<td align="left">▂▇▆▅▇</td>
</tr>
</tbody>
</table>
</div>
<div id="wide-to-long-format" class="section level2">
<h2>Wide to long format</h2>
<pre class="r"><code># this will add an index to the dataframe so you know what individual is which
iris_long.df &lt;- iris.df %&gt;% 
  mutate(individual = row_number()) %&gt;% 
  gather(trait, measure, -species, - individual)

head(iris_long.df)</code></pre>
<pre><code>## # A tibble: 6 x 4
##   species individual trait        measure
##   &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
## 1 setosa           1 sepal_length     5.1
## 2 setosa           2 sepal_length    NA  
## 3 setosa           3 sepal_length     4.7
## 4 setosa           4 sepal_length     4.6
## 5 setosa           5 sepal_length     5  
## 6 setosa           6 sepal_length     5.4</code></pre>
</div>
<div id="outliers" class="section level2">
<h2>Outliers</h2>
<pre class="r"><code># Box Plots of data
iris_long.df %&gt;% group_by(species, trait) %&gt;% 
  ggplot( aes(x = trait, y = measure, color = species, fill=species))+
  geom_boxplot(aes(alpha=0.3)) </code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="23_t_tests_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>These look good for the most part with only one or two significant. Your choice to transform or not.</p>
<p>##Factors<br />
Make sure the categorical variable is a factor<br />
Rearrange the order of groups so that control group is first, followed by treatment groups.<br />
you can do this by:</p>
<pre class="r"><code># Make Factors from the different levels long way
# iris_long.df$species &lt;- as.factor(iris_long.df$species)  
# iris_long.df$trait &lt;- as.factor(iris_long.df$trait) 

# Make Factors dplyr
iris_long.df &lt;- iris_long.df %&gt;%
  mutate(
    sex = factor(species, 
    labels = c(&quot;setosa&quot;, &quot;versicolor&quot;, &quot;virginica&quot;)),
    trait = factor(trait, 
    labels = c(&quot;sepal_length&quot;, &quot;sepal_width&quot;, &quot;petal_length&quot;, &quot;petal_width&quot;))
  )</code></pre>
</div>
<div id="test-for-normality-of-data-and-using-the-broom-package" class="section level2">
<h2>Test for normality of data and using the broom package</h2>
<p>So I think this is premature but some people like to test the normality of the data but really you should be assessing the normality of the residuals. But here it goes…</p>
<pre class="r"><code># turn off scientific notaton
options(scipen = 999)
# to turn back on 
#options(scipen = 0)

# Test for normality of each group and store in shapirowilktests
# This uses the broom package to get clean output of the test 
iris_long.df %&gt;% group_by(species, trait) %&gt;% do(tidy(shapiro.test(.$measure)))</code></pre>
<pre><code>## # A tibble: 12 x 5
## # Groups:   species, trait [12]
##    species    trait        statistic     p.value method                     
##    &lt;chr&gt;      &lt;fct&gt;            &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;                      
##  1 setosa     sepal_length     0.955 0.0548      Shapiro-Wilk normality test
##  2 setosa     sepal_width      0.800 0.000000866 Shapiro-Wilk normality test
##  3 setosa     petal_length     0.977 0.456       Shapiro-Wilk normality test
##  4 setosa     petal_width      0.972 0.272       Shapiro-Wilk normality test
##  5 versicolor sepal_length     0.966 0.158       Shapiro-Wilk normality test
##  6 versicolor sepal_width      0.948 0.0273      Shapiro-Wilk normality test
##  7 versicolor petal_length     0.978 0.465       Shapiro-Wilk normality test
##  8 versicolor petal_width      0.974 0.338       Shapiro-Wilk normality test
##  9 virginica  sepal_length     0.962 0.110       Shapiro-Wilk normality test
## 10 virginica  sepal_width      0.960 0.0870      Shapiro-Wilk normality test
## 11 virginica  petal_length     0.971 0.258       Shapiro-Wilk normality test
## 12 virginica  petal_width      0.967 0.181       Shapiro-Wilk normality test</code></pre>
<pre class="r"><code>#You can do this on all variables faster with if there was only one grouping
# tapply(iris_long.df$measure, iris_long.df$species, shapiro.test)</code></pre>
<p>##Test for homogenetiy of variances</p>
<p>Best to use the Levenes test compared to the Bartlet test<br />
uses the car package</p>
<p><a href="http://www.cookbook-r.com/Statistical_analysis/Homogeneity_of_variance/" class="uri">http://www.cookbook-r.com/Statistical_analysis/Homogeneity_of_variance/</a></p>
<p>Note however that this is doing the homogeneity test on all traits and not each one which is what you really should do and is not often done. Need to check on this though.</p>
<pre class="r"><code>#Test for homogeneity of variances by groups
leveneTest(sepal_length ~ species, data=iris.df)</code></pre>
<pre><code>## Warning in leveneTest.default(y = y, group = group, ...): group coerced to
## factor.</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value   Pr(&gt;F)   
## group   2  6.0386 0.003022 **
##       146                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#Compared to the Bartlet test
bartlett.test(sepal_length ~ species, data=iris.df)</code></pre>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  sepal_length by species
## Bartlett&#39;s K-squared = 15.308, df = 2, p-value = 0.0004742</code></pre>
<p>Create a subset dataframe</p>
<pre class="r"><code>sepal_length.df &lt;- iris_long.df %&gt;%
  filter(trait ==&quot;sepal_length&quot;) %&gt;%
  filter(species != &quot;setosa&quot;)</code></pre>
<p>If p-value &gt;= 0.05, use var.equal=TRUE below</p>
<pre class="r"><code>t.test(measure ~ species, data=sepal_length.df,
       var.equal=TRUE,
       conf.level=0.95)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  measure by species
## t = -12.604, df = 98, p-value &lt; 0.00000000000000022
## alternative hypothesis: true difference in means between group versicolor and group virginica is not equal to 0
## 95 percent confidence interval:
##  -1.495426 -1.088574
## sample estimates:
## mean in group versicolor  mean in group virginica 
##                    4.260                    5.552</code></pre>
<pre class="r"><code>t.test(measure ~ species, data=sepal_length.df,
       var.equal=FALSE,
       conf.level=0.95)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  measure by species
## t = -12.604, df = 95.57, p-value &lt; 0.00000000000000022
## alternative hypothesis: true difference in means between group versicolor and group virginica is not equal to 0
## 95 percent confidence interval:
##  -1.49549 -1.08851
## sample estimates:
## mean in group versicolor  mean in group virginica 
##                    4.260                    5.552</code></pre>
<p>Boxplot of data</p>
<pre class="r"><code>sepal_length.df %&gt;%
  ggplot(aes(species, measure, fill = species)) +
  geom_boxplot()</code></pre>
<p><img src="23_t_tests_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Mean and standard error plot</p>
<pre class="r"><code>sepal_length.df %&gt;% 
ggplot(aes(species, color=species)) + 
  stat_summary(aes(y = measure),
               fun.y = mean, na.rm = TRUE,
               geom = &quot;point&quot;,
               size = 3) + 
  stat_summary(aes(y = measure),
               fun.data = mean_se, na.rm = TRUE,
               geom = &quot;errorbar&quot;,
               width = 0.2) +
  labs(x = &quot;Species&quot;, y = &quot;Length&quot;) +
  scale_color_manual(name = &quot;Species&quot;, 
                     values = c(&quot;blue&quot;, &quot;red&quot;),
                     labels = c(&quot;Versicolor&quot;, &quot;Virginica&quot;))</code></pre>
<pre><code>## Warning: `fun.y` is deprecated. Use `fun` instead.</code></pre>
<p><img src="23_t_tests_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-88373117-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-88373117-4');
</script>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
